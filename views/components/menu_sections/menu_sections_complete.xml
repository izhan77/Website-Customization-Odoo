<?xml version="1.0" encoding="UTF-8"?>
<odoo>
    <!-- ================================= DYNAMIC MENU SECTIONS - FROM ODOO BACKEND ================================= -->
    <template id="menu_sections_complete" name="Complete Menu Sections">

        <!-- FETCH CATEGORIES FROM ODOO BACKEND -->
        <t t-set="categories" t-value="request.env['product.public.category'].sudo().search([('website_id', 'in', [False, request.website.id])], order='sequence, name')"/>

        <!-- LOOP THROUGH EACH CATEGORY -->
        <t t-foreach="categories" t-as="category">
            <!-- Generate section ID from category name -->
            <t t-set="category_slug" t-value="category.name.lower().replace('&amp;', '-').replace(' ', '-').replace('--', '-').replace('--', '-').strip('-') + '-section'"/>

            <!-- Get products for this category -->
            <t t-set="category_products" t-value="request.env['product.template'].sudo().search([
                ('public_categ_ids', 'in', [category.id]),
                ('website_published', '=', True)
            ], limit=20)"/>

            <!-- Only show section if it has products -->
            <t t-if="category_products">
                <section t-attf-id="#{category_slug}" class="menu-section py-16 bg-white">
                    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">

                        <!-- Section Header -->
                        <div class="text-center mb-12">
                            <h2 style="font-family: 'Roboto Condensed' !important; letter-spacing: -0.065em; margin-bottom: 0px !important;"
                                class="text-[5rem] md:text-[6rem] text-gray-900">
                                <t t-out="category.name.upper()"/>
                            </h2>
                        </div>

                        <!-- Products Grid -->
                        <div class="product-grid grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-x-8">
                            <!-- Loop through products in this category -->
                            <t t-foreach="category_products" t-as="product">
                                <t t-call="website_customizations.single_product_card">
                                    <t t-set="product_id" t-value="'product-' + str(product.id)"/>
                                    <t t-set="product_image" t-value="product.image_1920 and ('/web/image/product.template/%s/image_1920' % product.id) or '/website_customizations/static/src/images/product_1.jpg'"/>
                                    <t t-set="product_title" t-value="product.name"/>
                                    <t t-set="product_description" t-value="product.description_sale or product.name"/>
                                    <t t-set="product_original_price" t-value="'Rs. %.0f' % (product.list_price * 1.2)"/>
                                    <t t-set="product_discounted_price" t-value="'Rs. %.0f' % product.list_price"/>
                                    <t t-set="product_category" t-value="category_slug.replace('-section', '')"/>
                                </t>
                            </t>
                        </div>

                        <!-- Separator Line -->
                        <img src="/website_customizations/static/src/images/seperator-line.png"
                             class="w-full h-[3rem] object-cover mt-5"
                             alt="Line Seperator"/>
                    </div>
                </section>
            </t>
        </t>

    </template>
</odoo>